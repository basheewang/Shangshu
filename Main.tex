%% -*- coding: utf-8 -*-
%% Time-stamp: <Chen Wang: 2024-04-02 10:48:01>

\documentclass[zihao=-4,AutoFakeBold=true]{ctexbook}

\ctexset {
  part = {
    numbering = false
  },
  chapter = {
    numbering = false
  },
  section = {
    numbering = false
  },
  subsection = {
    numbering = false,
    format = \centering\bfseries,
  }
}

% \usepackage[margin=0.5cm]{geometry}
% For Meizu Hornor V10
\usepackage[
% showframe,
% includefoot,
% paperwidth=2.68in, % 2.68in,
paperwidth=3.79in,              %If for A4 paper size.
paperheight=5.36in,
left=0.1in,
right=0.1in,
top=0.1in,
bottom=0.20in,
footskip=10pt
]
{geometry}
% For Kindle 6'
% \usepackage[
% % showframe,
% paperwidth=3.6in,
% paperheight=4.8in,
% left=0.15in,
% right=0.15in,
% top=0.18in,
% bottom=0.18in,
% % footskip=10pt
% ]
% {geometry}

\usepackage{eso-pic}
\newcommand\BackgroundPic{%
  \put(0,0){%
    \parbox[b][\paperheight]{\paperwidth}{%
      \vfill
      \centering
      \includegraphics[width=\paperwidth,height=\paperheight,%
      keepaspectratio]{../bg.jpg}%
      \vfill
    }}}

\usepackage{xcolor}
\definecolor{BlueGrey}{HTML}{DBE1F1}
\definecolor{GreenRead}{HTML}{A8F29A}
\definecolor{GreyRead}{HTML}{D8D3D6}
\definecolor{YellowRead}{HTML}{F8FD89}
\definecolor{BlueRead}{HTML}{96ADFC}
\definecolor{Turquoise}{HTML}{A5F7E1}

\usepackage{xeCJKfntef}
\usepackage{xeCJK}
\xeCJKsetup{
  AutoFallBack = true,
  PunctStyle = kaiming,
  CheckFullRight = true,
  CheckSingle = false,
  AllowBreakBetweenPuncts = true,
  CJKmath = true,
}
% \setCJKmainfont[BoldFont={FZYouHei_GBK 513B},FallBack={BabelStone Han}]{FZYaSong-R-GBK}
\setCJKmainfont[BoldFont={FZYouHei_GBK 513B},FallBack={SimSun-ExtB}]{FZYaSong-R-GBK}% {FZNewKai-Z03}
% \setCJKmathfont{FZSongKeBenXiuKai-R-GBK}
% \setCJKmainfont[BoldFont={FZYouHei_GBK}]{FZYaSong-R-GBK}
\setCJKsansfont{Microsoft YaHei}
% \usepackage{CJKnumb}
\usepackage{zhnumber}
% 中文字体命令
\newCJKfontfamily[simsunb]\simsunb{SimSun-ExtB}
\newCJKfontfamily[hanaa]\hanaa{HanaMinA}
\newCJKfontfamily[hanab]\hanab{HanaMinB}
\newCJKfontfamily[fzbyks]\fzbyks{FZBoYaKanSongK}
\newCJKfontfamily[fzkt]\fzkt{FZNewKai-Z03}
\newCJKfontfamily[fzbys]\fzbys{FZYaSong-R-GBK}
\newCJKfontfamily[fzkeb]\fzkeb{FZKaiS-Extended(SIP)}
\newCJKfontfamily[jigmo]\jigmo{Jigmo} % For basic and ext A
\newCJKfontfamily[jigmotwo]\jigmotwo{Jigmo2} % For ext B.C.D.E.F
\newCJKfontfamily[jigmothree]\jigmothree{Jigmo3} % For ext G.H
\newfontfamily{\iosev}{IosevkaTerm NFM}


\newCJKfontfamily{\dejavusanszh}{DejaVu Sans} % this font has the required glyphs
\newfontface{\dejavusans}{DejaVu Sans} % this font has the required glyphs

\newcommand{\iching}[1]{{\dejavusanszh\char\numexpr"4DC0+#1}}
\newcommand{\trigram}[1]{{\dejavusans\char\numexpr"2630+#1}}

% 设置段落不缩进
% \setlength{\parindent}{0pt}

\usepackage{setspace}
\setstretch{1.3}

\usepackage{lastpage}
\usepackage{fancyhdr}
\fancyhead{}
\pagestyle{fancy}
\fancyfoot[C]{\scriptsize 第 \thepage\ 页（共 \pageref{LastPage} 页）}
% \fancyfoot[C]{\scriptsize 第 \thepage\ 页}
\renewcommand{\footrulewidth}{-10pt}
% \fancyhf{} % clear all header and footers
% \renewcommand{\headrulewidth}{0pt} % remove the header rule
% \rfoot{\thepage}
\fancypagestyle{plain}{%
  \renewcommand{\headrulewidth}{0pt}%
  \fancyhf{}%
}

\usepackage{fancyvrb}
\usepackage{fvextra}

\usepackage{framed}
\newenvironment{poem}[1][\hsize]{%
  \def\FrameCommand{{\color{red}\vrule width 0pt}\hspace{0pt}\fboxsep=\FrameSep}%
  \MakeFramed{\hsize#1\advance\hsize-\width\FrameRestore}}
{\endMakeFramed}

\usepackage{changepage}

% \usepackage{amssymb}
% \usepackage{mathabx}
\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{txfonts}
\usepackage{amsfonts}
\usepackage{enumitem}

\usepackage{emptypage}

%% Need to fix, bookmarksdepth=4 not work
\usepackage[hidelinks,pdfpagelayout=SinglePage]{hyperref}
% \usepackage[hidelinks,bookmarksdepth=4]{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,
  urlcolor=cyan,
}

%% 使每页的脚注的数字为黑色圆圈数字
\usepackage{pifont}
\makeatletter
\newcommand*{\bcircnum}[1]{%
  \expandafter\@bcircnum\csname c@#1\endcsname
}

\newcommand*{\@bcircnum}[1]{%
  \ifnum#1<1 %
  \@ctrerr
  \else
  \ifnum#1>30 %
  \@ctrerr
  \else
  \ding{\the\numexpr 181+(#1)\relax}%
  \fi
  \fi
}
\makeatother

\renewcommand*{\thefootnote}{\bcircnum{footnote}}

% \usepackage{booktabs}

\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}
% \setmainfont{FZYaSongS-R-GB}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip=0pt plus 1pt minus .1pt

% \newfontfamily\fzkeb[Path=./fonts/]{FZKaiSExtB.TTF}
% \newCJKfontfamily[kai]\fzkeb[Path=../../fonts/]{FZKaiSExtB.TTF}
% \newCJKfontfamily[kai]\hanaeb[Path=../../fonts/]{HanaMinB.ttf}
% \newCJKfontfamily[song]\hanaa[Path=~/.fonts/]{HanaMinA.ttf}
% \newCJKfontfamily[song]\hanab[Path=~/.fonts/]{HanaMinB.ttf}

%% Has problems when use \input or \include
% \usepackage{underscore}

\usepackage{xpinyin}
% \xpinyinsetup{
%   multiple={\color{red}}
%   % Sep={.1em plus .1em},
%   % font={\Large \bfseries}
% }

\usepackage[hang,flushmargin,perpage,stable]{footmisc}
% \renewcommand*{\footnotelayout}{\fontsize{6pt}{8pt}\selectfont\fzkt}
\renewcommand*{\footnotelayout}{\zihao{6}\fzkt}

% \usepackage{tcolorbox}
% \renewcommand{\footnotesize}{\fontsize{6pt}{8pt}\selectfont}

% \usepackage{etoolbox}
% \makeatletter
% \patchcmd{\@footnotetext}{\footnotesize}{\footnotesize\KaiTi}{}{}
% \makeatother

\newcommand{\sy}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{sy.png}%
  \endgroup
}
\newcommand{\jj}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{jj.png}%
  \endgroup
}
\newcommand{\zy}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{zy.png}%
  \endgroup
}
\newcommand{\jinjie}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{jinjie.png}%
  \endgroup
}
\newcommand{\jinyi}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{jinyi.png}%
  \endgroup
}
\newcommand{\shu}{%
  \begingroup\normalfont
  \includegraphics[height=1.1\fontcharht\font`\B]{shu.png}%
  \endgroup
}
\newcommand{\zhu}{%
  \begingroup\normalfont
  \includegraphics[height=1.1\fontcharht\font`\B]{zhu.png}%
  \endgroup
}
\newcommand{\jian}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{jian.png}%
  \endgroup
}
\newcommand{\zhuan}{%
  \begingroup\normalfont
  \includegraphics[height=1.3\fontcharht\font`\B]{zhuan.png}%
  \endgroup
}

\usepackage{makeidx}
\makeindex
% \DeclareRobustCommand{\myidx}[1]{{\Unifont #1}\index{#1}}
\DeclareRobustCommand{\myidx}[1]{{\fzzcys #1}\index{#1}}
% \DeclareRobustCommand{\myidxp}[1]{{\fzzcys \CJKunderline-{#1}}\index{#1}}
% \DeclareRobustCommand{\myidxb}[1]{{\fzzcys \CJKunderwave-{#1}}\index{#1}}

\usepackage{xparse}
\NewDocumentCommand{\myidxp}{mO{#1}}{{\fzzcys \CJKunderline-{#1}}\index{#2}}
\NewDocumentCommand{\myidxb}{mO{#1}}{{\fzzcys \CJKunderwave-{#1}}\index{#2}}

\usepackage[totoc,font=small,rule=0.2pt]{idxlayout}
\usepackage{parskip}

%% title & author
\title{\bfseries 尚\ 書\ 正\  義}
\author{漢·孔安國（注） \\ 唐·孔穎達（疏）}
\date{}

\begin{document}

%% Looks has problems when use \input or \include.
\AddToShipoutPicture*{\BackgroundPic}

\clearpage\maketitle
\clearpage\tableofcontents\thispagestyle{empty}
\newpage

\pagenumbering{arabic}
% \pagecolor{BlueGrey}
\zihao{4}

%% 正文

% \input{main/001_Juan_01}
% \input{main/002_Juan_02}
% \input{main/003_Juan_03}
% \input{main/004_Juan_04}
% \input{main/005_Juan_05}
% \input{main/006_Juan_06}
% \input{main/007_Juan_07}
% \input{main/008_Juan_08}
% \input{main/009_Juan_09}
% \input{main/010_Juan_10}
% \input{main/011_Juan_11}
% \input{main/012_Juan_12}
\input{main/013_Juan_13}

% \input{main/014_Juan_14}
% \input{main/015_Juan_15}
% \input{main/016_Juan_16}
% \input{main/017_Juan_17}
% \input{main/018_Juan_18}
% \input{main/019_Juan_19}
% \input{main/020_Juan_20}


% Draft only
% \input{all_new}

%% 索隐
% \printindex
% \addcontentsline{toc}{part}{索引}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-engine: xetex
%%% TeX-master: t
%%% End:
